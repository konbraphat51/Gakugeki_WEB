{"ast":null,"code":"export var createMediaDevices = function createMediaDevices(emitNotSupportedError, window, wrapSubscribeFunction) {\n  return function () {\n    return wrapSubscribeFunction(function (observer) {\n      if (window === null || window.navigator === undefined || window.navigator.mediaDevices === undefined || window.navigator.mediaDevices.enumerateDevices === undefined) {\n        return emitNotSupportedError(observer);\n      }\n\n      var isActive = true;\n\n      var enumerateDevices = function enumerateDevices() {\n        window.navigator.mediaDevices.enumerateDevices().then(function (mediaDevices) {\n          if (isActive) {\n            observer.next(mediaDevices);\n          }\n        }, function (err) {\n          if (isActive) {\n            unsubscribe();\n            observer.error(err);\n          }\n        });\n      };\n\n      var unsubscribe = function unsubscribe() {\n        isActive = false;\n        window.navigator.mediaDevices.removeEventListener('devicechange', enumerateDevices);\n      };\n\n      enumerateDevices();\n      window.navigator.mediaDevices.addEventListener('devicechange', enumerateDevices);\n      return unsubscribe;\n    });\n  };\n};","map":{"version":3,"mappings":"AAEA,OAAO,IAAMA,kBAAkB,GAAyB,SAA3CA,kBAA2C,CAACC,qBAAD,EAAwBC,MAAxB,EAAgCC,qBAAhC,EAAyD;EAC7G,OAAO;IAAA,OACHA,qBAAqB,CAAC,UAACC,QAAD,EAAa;MAC/B,IACIF,MAAM,KAAK,IAAX,IACAA,MAAM,CAACG,SAAP,KAAqBC,SADrB,IAEAJ,MAAM,CAACG,SAAP,CAAiBE,YAAjB,KAAkCD,SAFlC,IAGAJ,MAAM,CAACG,SAAP,CAAiBE,YAAjB,CAA8BC,gBAA9B,KAAmDF,SAJvD,EAKE;QACE,OAAOL,qBAAqB,CAACG,QAAD,CAA5B;MACH;;MAED,IAAIK,QAAQ,GAAG,IAAf;;MAEA,IAAMD,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAK;QAC1BN,MAAM,CAACG,SAAP,CAAiBE,YAAjB,CAA8BC,gBAA9B,GAAiDE,IAAjD,CACI,UAACH,YAAD,EAAiB;UACb,IAAIE,QAAJ,EAAc;YACVL,QAAQ,CAACO,IAAT,CAAcJ,YAAd;UACH;QACJ,CALL,EAMI,UAACK,GAAD,EAAQ;UACJ,IAAIH,QAAJ,EAAc;YACVI,WAAW;YAEXT,QAAQ,CAACU,KAAT,CAAeF,GAAf;UACH;QACJ,CAZL;MAcH,CAfD;;MAgBA,IAAMC,WAAW,GAAG,SAAdA,WAAc,GAAK;QACrBJ,QAAQ,GAAG,KAAX;QACAP,MAAM,CAACG,SAAP,CAAiBE,YAAjB,CAA8BQ,mBAA9B,CAAkD,cAAlD,EAAkEP,gBAAlE;MACH,CAHD;;MAKAA,gBAAgB;MAChBN,MAAM,CAACG,SAAP,CAAiBE,YAAjB,CAA8BS,gBAA9B,CAA+C,cAA/C,EAA+DR,gBAA/D;MAEA,OAAOK,WAAP;IACH,CArCoB,CADlB;EAAA,CAAP;AAuCH,CAxCM","names":["createMediaDevices","emitNotSupportedError","window","wrapSubscribeFunction","observer","navigator","undefined","mediaDevices","enumerateDevices","isActive","then","next","err","unsubscribe","error","removeEventListener","addEventListener"],"sources":["C:\\Users\\brigh\\storage\\js_project\\Gakugeki_WEB\\node_modules\\subscribable-things\\src\\factories\\media-devices.ts"],"sourcesContent":["import { TMediaDevicesFactory } from '../types';\n\nexport const createMediaDevices: TMediaDevicesFactory = (emitNotSupportedError, window, wrapSubscribeFunction) => {\n    return () =>\n        wrapSubscribeFunction((observer) => {\n            if (\n                window === null ||\n                window.navigator === undefined ||\n                window.navigator.mediaDevices === undefined ||\n                window.navigator.mediaDevices.enumerateDevices === undefined\n            ) {\n                return emitNotSupportedError(observer);\n            }\n\n            let isActive = true;\n\n            const enumerateDevices = () => {\n                window.navigator.mediaDevices.enumerateDevices().then(\n                    (mediaDevices) => {\n                        if (isActive) {\n                            observer.next(mediaDevices);\n                        }\n                    },\n                    (err) => {\n                        if (isActive) {\n                            unsubscribe();\n\n                            observer.error(err);\n                        }\n                    }\n                );\n            };\n            const unsubscribe = () => {\n                isActive = false;\n                window.navigator.mediaDevices.removeEventListener('devicechange', enumerateDevices);\n            };\n\n            enumerateDevices();\n            window.navigator.mediaDevices.addEventListener('devicechange', enumerateDevices);\n\n            return unsubscribe;\n        });\n};\n"]},"metadata":{},"sourceType":"module"}